facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (52.5% Var. Expl.)")+
ylab("PCoA2 (42.4% Var. Expl.)")
View(new.dat)
###############################
# Analysis and figures
##############################
##############
#    PCoAs   #
##############
###	#PCoA with Bray-Curtis Distances#	###
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[15:17] <- c("microbe","juice","hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$microbe, new.order = c("FF", "PA"))
new.dat$Hour <- reorder.factor(new.dat$hour, new.order = c("2","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Microbe, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (61.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (47.3% Var. Expl.)")
sample_data(VOC)$fday <- factor(sample_data(VOC)$hour)
sample_data(VOC)$fmicrobe <- factor(sample_data(VOC)$microbe)
sample_data(VOC)$fnectar <- factor(sample_data(VOC)$rep)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$fnectar+ sample_data(VOC)$fday+
+ sample_data(VOC)$fmicrobe)
summary(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$fnectar * sample_data(VOC)$fday * sample_data(VOC)$fmicrobe)
summary(fit)
sample_data(VOC)$fday <- factor(sample_data(VOC)$hour)
sample_data(VOC)$fmicrobe <- factor(sample_data(VOC)$microbe)
sample_data(VOC)$fnectar <- factor(sample_data(VOC)$rep)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$fnectar+ sample_data(VOC)$fday+
+ sample_data(VOC)$fmicrobe)
summary(fit)
# same results
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$fnectar * sample_data(VOC)$fday * sample_data(VOC)$fmicrobe)
summary(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep+ sample_data(VOC)$fday+
+ sample_data(VOC)$microbe)
anova(fit)
TukeyHSD(aov(fit), which="sample_data(VOC)$microbe")
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep+ sample_data(VOC)$fday+
+ sample_data(VOC)$microbe)
anova(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep+ sample_data(VOC)$fday+
+ sample_data(VOC)$microbe)
anova(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep+ sample_data(VOC)$fday+
+ sample_data(VOC)$microbe)
anova(fit)
TukeyHSD(aov(fit), which="sample_data(VOC)$microbe")
TukeyHSD(aov(fit), which="sample_data(VOC)$rep")
TukeyHSD(aov(fit), which="sample_data(VOC)$fday")
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday
* sample_data(VOC)$microbe)
aov(fit)
######################################################################################################################################
Analysis of Variance Table
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday
* sample_data(VOC)$microbe)
aov(fit)
TukeyHSD(aov(fit), which="sample_data(VOC)$fday")
TukeyHSD(aov(fit), which="sample_data(VOC)$rep")
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday
* sample_data(VOC)$microbe)
aov(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$fday
* sample_data(VOC)$microbe)
aov(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday
* sample_data(VOC)$microbe)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday
* sample_data(VOC)$microbe)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday
* sample_data(VOC)$microbe)
aov(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$fday
* sample_data(VOC)$microbe)
aov(fit)
fit <- lm(sample_sums(VOC)~ sample_data(VOC)$rep* sample_data(VOC)$fday *sample_data(VOC)$microbe)
aov(fit)
fit <- lm(sample_sums(VOC)~sample_data(VOC)$fday *sample_data(VOC)$microbe)
aov(fit)
TukeyHSD(aov(fit), which="sample_data(VOC)$fday")
TukeyHSD(aov(fit), which="sample_data(VOC)$rep")
TukeyHSD(aov(fit), which="sample_data(VOC)$microbe")
fit <- lm(sample_sums(VOC)~sample_data(VOC)$fday
aov(fit)
fit <- lm(sample_sums(VOC)~sample_data(VOC)$fday)
aov(fit)
TukeyHSD(aov(fit), which="sample_data(VOC)$rep")
TukeyHSD(aov(fit), which="sample_data(VOC)$microbe")
TukeyHSD(aov(fit), which="sample_data(VOC)$fday")
TukeyHSD(aov(fit), which="sample_data(VOC)$microbe")
DayTwo <- subset_samples(VOC, day=="2")
DayTwo <- subset_samples(VOC, hour=="2")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$rep * sample_data(DayTwo)$microbe)
DayTwo <- subset_samples(VOC, Hour=="2")
DayTwo <- subset_samples(VOC, hour=="2")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$rep * sample_data(DayTwo)$microbe)
aov(fit)
DayTwo <- subset_samples(VOC, hour=="24")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$rep * sample_data(DayTwo)$microbe)
aov(fit)
summary(fit)
DayTwo <- subset_samples(VOC, hour=="2")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$rep * sample_data(DayTwo)$microbe)
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$day * sample_data(DayTwo)$microbe)
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$fday * sample_data(DayTwo)$microbe)
DayTwo <- subset_samples(VOC, hour=="2"| hour=="24")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$fday * sample_data(DayTwo)$microbe)
summary(fit)
aov(fit)
summary
summary(fit)
##########################################################################################################
Analysis of Variance Table
summary(fit)
aov(fit)
anova(fit)
DayTwo <- subset_samples(VOC, hour=="2")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$fday * sample_data(DayTwo)$microbe)
DayTwo <- subset_samples(VOC, hour=="2"| hour=="24")
fit <- lm(sample_sums(DayTwo)~ sample_data(DayTwo)$fday * sample_data(DayTwo)$microbe)
anova(fit)
TukeyHSD(aov(fit), which="sample_data(DayTwo)$microbe.treatmemt")
TukeyHSD(aov(fit), which="sample_data(DayTwo)$microbe")
abund <- round(abund[,-c(1:2)], digits = 0)
OTU <- otu_table(abund, taxa_are_rows=T)
VOC <- phyloseq(OTU, TAX, SAMP)
VOC
plot_richness(VOC, x = "microbe", measures = c("Observed", "Shannon", "Simpson"))
plot_richness(VOC, x = "rep", measures = c("Observed", "Shannon", "Simpson"))
fit <- lm(estimate_richness(VOC)$Shannon ~ sample_data(VOC)$microbe)
anova(fit)
fit <- lm(estimate_richness(VOC)$Observed ~ sample_data(VOC)$microbe)
fit
fit <- lm(estimate_richness(VOC)$Simpson ~ sample_data(VOC)$microbe)
fit
fit <- lm(estimate_richness(VOC)$Shannon ~ sample_data(VOC)$rep)
fit
fit <- lm(estimate_richness(VOC)$Shannon ~ sample_data(VOC)$rep)
fit
library("DESeq2")
deobj <- phyloseq_to_deseq2(VOC, ~ fday + microbe)
diagdds = DESeq(deobj, test="Wald", fitType="local")
#NoZero <- subset_samples(VOC, hour!="2")
deobj <- phyloseq_to_deseq2(VOC, ~  sample_data(VOC)$fday + microbe)
#NoZero <- subset_samples(VOC, hour!="2")
deobj <- phyloseq_to_deseq2(VOC, ~  sample_data(VOC)$fday +  sample_data(VOC)$microbe)
diagdds = DESeq(deobj, test="Wald", fitType="local")
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyr")
#install.packages("Rmisc")
library(Rmisc)
library(tidyr)
library(readxl)
library(ggplot2)
library(boot)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/RAW_swd_vs_inoculated_blueberryjuice.xlsx",
sheet = "data4r")
#View(data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(microbe, flies_in_treat, flies_outside, flies_in_control) %>%
dplyr::filter(microbe== "C0621") %>%
tidyr::gather(location, observed, flies_in_treat:flies_in_control)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyr")
#install.packages("Rmisc")
library(Rmisc)
library(tidyr)
library(readxl)
library(ggplot2)
library(boot)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/RAW_swd_vs_inoculated_blueberryjuice.xlsx",
sheet = "data4r")
#View(data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(microbe, flies_in_treat, flies_outside, flies_in_control) %>%
dplyr::filter(microbe== "C0621") %>%
tidyr::gather(location, observed, flies_in_treat:flies_in_control)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/data.xlsx")
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyr")
#install.packages("Rmisc")
library(Rmisc)
library(tidyr)
library(readxl)
library(ggplot2)
library(boot)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/data.xlsx")
#View(data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(microbe, trap1_catch, flies_outside, trap2_catch) %>%
dplyr::filter(microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyr")
#install.packages("Rmisc")
library(Rmisc)
library(tidyr)
library(readxl)
library(ggplot2)
library(boot)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/data.xlsx")
#View(data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(microbe, trap1_catch, flies_outside, trap2_catch) %>%
dplyr::filter(microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyr")
#install.packages("Rmisc")
library(Rmisc)
library(tidyr)
library(readxl)
library(ggplot2)
library(boot)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/data.xlsx")
#View(data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_catch, flies_outside, trap2_catch) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyr")
#install.packages("Rmisc")
library(Rmisc)
library(tidyr)
library(readxl)
library(ggplot2)
library(boot)
data = read_excel("~/GitHub/BACandBlue/data/BaCandBLUE_Bioassay/data.xlsx")
#View(data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_microbe, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0633=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0633") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0185=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0185") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0189=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0189") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0634=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0634") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
###########################################
#### Visualizing all the treatment results
###########################################
ggplot(data, aes(x=trap1_microbe, y=trap1_catch))+geom_boxplot()+labs(x = "Microbe ID", y="# of Flies")
data1=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
ggplot(data1, aes(x=location, y=observed))+geom_boxplot()+facet_wrap(~trap1_microbe)+labs(x = "Treatment", y="# of Flies")+scale_x_discrete(labels=c("flies_in_treat"="Treatment", "flies_in_control"="Control", "flies_outside"="No Choice"))
##########################################################################################
#Normality Test and Linear models for the effect of each microbe on the flies in treatment
##########################################################################################
mod=lm(flies_in_treat~trap1_microbe,data)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0633=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0633") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0185=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0185") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0189=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0189") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0634=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0634") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
###########################################
#### Visualizing all the treatment results
###########################################
ggplot(data, aes(x=trap1_microbe, y=trap1_catch))+geom_boxplot()+labs(x = "Microbe ID", y="# of Flies")
data1=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
ggplot(data1, aes(x=location, y=observed))+geom_boxplot()+facet_wrap(~trap1_microbe)+labs(x = "Treatment", y="# of Flies")+scale_x_discrete(labels=c("flies_in_treat"="Treatment", "flies_in_control"="Control", "flies_outside"="No Choice"))
##########################################################################################
#Normality Test and Linear models for the effect of each microbe on the flies in treatment
##########################################################################################
mod=lm(trap1_catch~trap1_microbe,data)
summary(mod)
plot(mod)
mod0621=lm(observed~location,data0621)
summary(mod0621)
plot(mod0621)
mod0620=lm(observed~location,data0620)
summary(mod0620)
plot(mod0620)
mod0633=lm(observed~location,data0633)
summary(mod0633)
plot(mod0633)
mod0185=lm(observed~location,data0185)
summary(mod0185)
plot(mod0185)
mod0189=lm(observed~location,data0189)
summary(mod0189)
plot(mod0189)
mod0634=lm(observed~location,data0634)
summary(mod0634)
plot(mod0634)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0633=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0633") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0185=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0185") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0189=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0189") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0634=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0634") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
###########################################
#### Visualizing all the treatment results
###########################################
ggplot(data, aes(x=trap1_microbe, y=trap1_catch))+geom_boxplot()+labs(x = "Microbe ID", y="# of Flies")
data1=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
ggplot(data1, aes(x=location, y=observed))+geom_boxplot()+facet_wrap(~trap1_microbe)+labs(x = "Treatment", y="# of Flies")+scale_x_discrete(labels=c("flies_in_treat"="Treatment", "flies_in_control"="Control", "flies_outside"="No Choice"))
##########################################################################################
#Normality Test and Linear models for the effect of each microbe on the flies in treatment
##########################################################################################
mod=lm(trap1_catch~trap1_microbe,data)
summary(mod)
plot(mod)
mod0621=lm(observed~location,data0621)
summary(mod0621)
plot(mod0621)
mod0620=lm(observed~location,data0620)
summary(mod0620)
plot(mod0620)
mod0633=lm(observed~location,data0633)
summary(mod0633)
plot(mod0633)
mod0185=lm(observed~location,data0185)
summary(mod0185)
plot(mod0185)
mod0189=lm(observed~location,data0189)
summary(mod0189)
plot(mod0189)
mod0634=lm(observed~location,data0634)
summary(mod0634)
plot(mod0634)
#################################################################################
###Subsetting data to look at the relationship between isolate and SWD behaviors
#################################################################################
data0621=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0621") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0620=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0620") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0633=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0633") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0185=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0185") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0189=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0189") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
data0634=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
dplyr::filter(trap1_microbe== "C0634") %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
###########################################
#### Visualizing all the treatment results
###########################################
ggplot(data, aes(x=trap1_microbe, y=trap1_catch))+geom_boxplot()+labs(x = "Microbe ID", y="# of Flies")
data1=data %>%
dplyr::select(trap1_microbe, trap1_catch, flies_outside, trap2_catch,legs_up) %>%
tidyr::gather(location, observed, trap1_catch:legs_up)
ggplot(data1, aes(x=location, y=observed))+geom_boxplot()+facet_wrap(~trap1_microbe)+labs(x = "Treatment", y="# of Flies")+scale_x_discrete(labels=c("flies_in_treat"="Treatment", "flies_in_control"="Control", "flies_outside"="No Choice"))
##########################################################################################
#Normality Test and Linear models for the effect of each microbe on the flies in treatment
##########################################################################################
mod=lm(trap1_catch~trap1_microbe,data)
summary(mod)
plot(mod)
mod0621=lm(observed~location,data0621)
summary(mod0621)
plot(mod0621)
mod0620=lm(observed~location,data0620)
summary(mod0620)
plot(mod0620)
mod0633=lm(observed~location,data0633)
summary(mod0633)
plot(mod0633)
mod0185=lm(observed~location,data0185)
summary(mod0185)
plot(mod0185)
mod0189=lm(observed~location,data0189)
summary(mod0189)
plot(mod0189)
mod0634=lm(observed~location,data0634)
summary(mod0634)
plot(mod0634)
