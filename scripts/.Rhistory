#########################
#Jaccard distances PCoAs#
#########################
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new matrix
names(new.dat)[9:11] <- c("Microbe", "Hour", "Rep")
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("SWD"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24", "48"))
###
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Rep, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (50.5% Var. Expl.)")+
ylab("PCoA2 (12.7% Var. Expl.)")
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) #
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[11:13] <- c("Microbe","Rep","Hour") #for the "must be the same length as vecto
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[9:11] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new ma
###################################################################
## Organizing the datatables to be compatiable with the phyloseq.##
###################################################################
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak2.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu6.csv", colClasses = c("factor","factor", rep("numeric", times= 12)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak2.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
#returns: "phyloseq-class experiment-level object
#otu_table()   OTU Table:       [ 77 taxa and 14 samples ] "taxa" = VOCs "samples" = SPME-HS samples
#sample_data() Sample Data:     [ 14 samples by 9 sample variables ] "sample variable" = categories
#tax_table()   Taxonomy Table:  [ 77 taxa by 2 taxonomic ranks ] "taxonomic rank" = sample time/hour"
#############################
#Bray-Curtis Distances PCoAs#
#############################
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[9:11] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
#########################
#Jaccard distances PCoAs#
#########################
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new matrix
names(new.dat)[11:13] <- c("Microbe", "Hour", "Rep")
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("SWD"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24", "48"))
###
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Rep, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (50.5% Var. Expl.)")+
ylab("PCoA2 (12.7% Var. Expl.)")
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
######################################################
#Loads libraries necessary to use phyloseq package ###
######################################################
# Libraries and Data Frames
##what you need to install phyloseq
#source('http://bioconductor.org/biocLite.R')
#biocLite('phyloseq')
#install.packages("devtools")
#install_github("vqv/ggbiplot")
#install.packages("gdata")
install.packages("RSQLite")
View(abund)
install.packages("processx")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
#BiocManager::install()
library(tidyverse)
library(gdata)
library(processx)
library(devtools)
library(ggplot2)
library(beeswarm)
library(phyloseq) #install via bioconductor
library(vegan)
library(ggbiplot)
library(readxl)
library(readr)
library(ape)
library(DESeq2)
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu1.csv", colClasses = c("factor","factor", rep("numeric", times= 30)))# read in peak ar
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a ne
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[19:21] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("02","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make
View(abund)
###################################################################
## Organizing the datatables to be compatiable with the phyloseq.##
###################################################################
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu1.csv", colClasses = c("factor","factor", rep("numeric", times= 30)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
#returns: "phyloseq-class experiment-level object
#otu_table()   OTU Table:       [ 77 taxa and 14 samples ] "taxa" = VOCs "samples" = SPME-HS samples
#sample_data() Sample Data:     [ 14 samples by 9 sample variables ] "sample variable" = categories
#tax_table()   Taxonomy Table:  [ 77 taxa by 2 taxonomic ranks ] "taxonomic rank" = sample time/hour"
#############################
#Bray-Curtis Distances PCoAs#
#############################
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[19:21] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("02","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
#########################
#Jaccard distances PCoAs#
#########################
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new matrix
names(new.dat)[24:26] <- c("Microbe", "Hour", "Rep")
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("SWD"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("02","24","48"))
###
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Rep, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (50.5% Var. Expl.)")+
ylab("PCoA2 (12.7% Var. Expl.)")
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu2.csv", colClasses = c("factor","factor", rep("numeric", times= 30)))# read in peak areas, assigning factors of diff classifications based on columns
View(abund)
### Group 2: VOC collections from Process Blanks and Treatments)
```{r Group 2: Process, Reps, message=TRUE, warning=FALSE, paged.print=TRUE}
###################################################################
## Organizing the datatables to be compatiable with the phyloseq.##
###################################################################
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu2.csv", colClasses = c("factor","factor", rep("numeric", times= 22)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
#returns: "phyloseq-class experiment-level object
#otu_table()   OTU Table:       [ 77 taxa and 14 samples ] "taxa" = VOCs "samples" = SPME-HS samples
#sample_data() Sample Data:     [ 14 samples by 9 sample variables ] "sample variable" = categories
#tax_table()   Taxonomy Table:  [ 77 taxa by 2 taxonomic ranks ] "taxonomic rank" = sample time/hour"
#############################
#Bray-Curtis Distances PCoAs#
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu2.csv", colClasses = c("factor","factor", rep("numeric", times= 22)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour)
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu2.csv", colClasses = c("factor","factor", rep("numeric", times= 22)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # mak
View(new.dat)
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[14:16] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new matrix
names(new.dat)[17:19] <- c("Microbe", "Hour", "Rep")
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("SWD"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2", "24", "48"))
###
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Rep, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (50.5% Var. Expl.)")+
ylab("PCoA2 (12.7% Var. Expl.)")
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu3.csv", colClasses = c("factor","factor", rep("numeric", times= 30)))# read in peak areas, assigning fac
View(abund)
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
#returns: "phyloseq-class experiment-level object
#otu_table()   OTU Table:       [ 77 taxa and 14 samples ] "taxa" = VOCs "samples" = SPME-HS samples
#sample_data() Sample Data:     [ 14 samples by 9 sample variables ] "sample variable" = categories
#tax_table()   Taxonomy Table:  [ 77 taxa by 2 taxonomic ranks ] "taxonomic rank" = sample time/hour"
#############################
#Bray-Curtis Distances PCoAs#
#############################
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # mak
###################################################################
## Organizing the datatables to be compatiable with the phyloseq.##
###################################################################
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu3.csv", colClasses = c("factor","factor", rep("numeric", times= 13)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
#returns: "phyloseq-class experiment-level object
#otu_table()   OTU Table:       [ 77 taxa and 14 samples ] "taxa" = VOCs "samples" = SPME-HS samples
#sample_data() Sample Data:     [ 14 samples by 9 sample variables ] "sample variable" = categories
#tax_table()   Taxonomy Table:  [ 77 taxa by 2 taxonomic ranks ] "taxonomic rank" = sample time/hour"
#############################
#Bray-Curtis Distances PCoAs#
#############################
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[10:12] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
#########################
#Jaccard distances PCoAs#
#########################
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new matrix
names(new.dat)[11:13] <- c("Microbe", "Hour", "Rep")
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("SWD"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24", "48"))
###
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Rep, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (50.5% Var. Expl.)")+
ylab("PCoA2 (12.7% Var. Expl.)")
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a n
###################################################################
## Organizing the datatables to be compatiable with the phyloseq.##
###################################################################
meta <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/meta.csv")
meta$hour=as.factor(meta$hour)
rownames(meta) <- meta$SampleID_merge
SAMP <- sample_data(meta)
sample_names(SAMP)<-meta$SampleID
peaks <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/peak1.csv")
TAX <- tax_table(peaks) # gives a warning, don't freak out
taxa_names(TAX)<-peaks$Peak_ID
colnames(TAX)<- colnames(peaks)
abund <- read.csv("~/GitHub/BACandBlue/data/BACandBLUE_GCdata_FFaeni_10BB_BLANK_PRO_REP/otu3.csv", colClasses = c("factor","factor", rep("numeric", times= 13)))# read in peak areas, assigning factors of diff classifications based on columns
rownames(abund) <- abund$Peak_ID #give abund rows names according to "Peak_ID" in peak1.csv table
OTU <- otu_table(abund[,-c(1:2)], taxa_are_rows=T) #create a table with only peak areas, compounds are taxa
VOC <- phyloseq(OTU, TAX, SAMP) #IF YOU GET A "SAMPLE_NAMES()" ERROR MAKE SURE YOUR NAMES DO NOT START WITH A NUMBER
#returns: "phyloseq-class experiment-level object
#otu_table()   OTU Table:       [ 77 taxa and 14 samples ] "taxa" = VOCs "samples" = SPME-HS samples
#sample_data() Sample Data:     [ 14 samples by 9 sample variables ] "sample variable" = categories
#tax_table()   Taxonomy Table:  [ 77 taxa by 2 taxonomic ranks ] "taxonomic rank" = sample time/hour"
#############################
#Bray-Curtis Distances PCoAs#
#############################
ord <- ordinate(VOC, method = "PCoA", distance = "bray")
plot_ordination(VOC, ord, color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
plot_ordination(VOC, ord, type = "juice", color = "hour", shape = "microbe", label = "rep")+
theme_bw() + theme(text = element_text(size = 20)) + geom_point(size = 4)
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$rep, sample_data(VOC)$hour) # make a new matrix
names(new.dat)[10:12] <- c("Microbe","Rep","Hour") #for the "must be the same length as vector" error make sure that the info inside the bracets matches empty columns in the dataframe your creating"
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("FF"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24","48"))
summary(new.dat)
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Hour, shape = Rep), position ="jitter") +
#facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (62.5% Var. Expl.)")+ 	## !don't forget to update these moving forward!
ylab("PCoA2 (15.7% Var. Expl.)")
#########################
#Jaccard distances PCoAs#
#########################
ord <- ordinate(VOC, method = "PCoA", distance = "jaccard")
plot_ordination( VOC, ord, color = "hour", shape = "microbe", type = "samples")
# split plot of compounds driving separation and samples in PC1/PC2.
plot_ordination(VOC, ord, type = "samples", color = "hour", shape = "microbe", label = "rep")
###
PCs <- data.frame(scores(ord$vectors))
new.dat <- cbind(PCs, sample_data(VOC)$microbe, sample_data(VOC)$hour, sample_data(VOC)$rep) # make a new matrix
names(new.dat)[11:13] <- c("Microbe", "Hour", "Rep")
library(gdata)
new.dat$Microbe <- reorder.factor(new.dat$Microbe, new.order = c("SWD"))
new.dat$Hour <- reorder.factor(new.dat$Hour, new.order = c("2","24", "48"))
###
ggplot(new.dat, aes(x=Axis.1, y= Axis.2)) +
geom_point(aes(color = Rep, shape = Hour), position ="jitter") +
facet_grid(~Hour)+
theme_bw()+
xlab("PCoA1 (50.5% Var. Expl.)")+
ylab("PCoA2 (12.7% Var. Expl.)")
